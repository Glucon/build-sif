Bootstrap: docker-archive
From: ./debian12.11.tar

%labels
    Maintainer yangys
    App Gaussian 16 C02 in debian 12.11

%files
    ./g16C02_no_tests.tar.bz2 /opt

%post -c /bin/bash
    sed -i 's|deb.debian.org|mirrors.cernet.edu.cn|g' /etc/apt/sources.list.d/debian.sources
    sed -i 's|security.debian.org/debian-security|mirrors.cernet.edu.cn/debian-security|g' /etc/apt/sources.list.d/debian.sources

    apt-get update && apt-get install -y --no-install-recommends \
        lbzip2

    tar -xf /opt/g16C02_no_tests.tar.bz2 -C /opt
    chmod -R 750 /opt/g16
    chown -R root:users /opt/g16
    rm -rf /opt/g16C02_no_tests.tar.bz2

    apt-get purge -y \
    lbzip2

    apt-get autoremove -y
    apt-get clean
    rm -rf /var/lib/apt/lists/* /root/.cache

    cp /opt/g16/bsd/g16.profile /opt/g16/bsd/g16.profile.sh
    sed -i '/ulimit/d' /opt/g16/bsd/g16.profile.sh

%environment
    export g16root=/opt
    source /opt/g16/bsd/g16.profile.sh

%runscript
    #!/bin/bash
    source /opt/g16/bsd/g16.profile
    exec g16 "$@"
